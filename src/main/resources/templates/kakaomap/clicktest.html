<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8">
        <title>지도 버튼클릭 테스트</title>
        <style>

        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    </head>
    <body>
        <div>
            <!--체크박스 버튼-->
           <div id="state">
                <input value="still" type="checkbox" class="btn-check" id="still" autocomplete="off">
                <label class="btn" for="still">still</label>

                <input value="open" type="checkbox" class="btn-check" id="open" autocomplete="off">
                <label class="btn" for="open">open</label>

                <input value="end" type="checkbox" class="btn-check" id="end" autocomplete="off">
                <label class="btn" for="end">end</label>
            </div>
            <div id="type">
                <input value="reserve" type="checkbox" class="btn-check" id="reserve" autocomplete="off">
                <label class="btn btn-outline-primary" for="reserve">reserve</label>

                <input value="wait" type="checkbox" class="btn-check" id="wait" autocomplete="off">
                <label class="btn btn-outline-secondary" for="wait">wait</label>

                <input value="both" type="checkbox" class="btn-check" id="both" autocomplete="off">
                <label class="btn btn-outline-secondary" for="both">both</label>
            </div>

            <!--radio 버튼-->
            <div>
                <div>
                    핫플
                    <input type="radio" class="btn-check" name="options-outlined" id="seongsu" autocomplete="off">
                    <label class="btn btn-outline-danger" for="seongsu">성수</label>

                    <input type="radio" class="btn-check" name="options-outlined" id="jamsil" autocomplete="off">
                    <label class="btn btn-outline-danger" for="jamsil">잠실</label>

                    <input type="radio" class="btn-check" name="options-outlined" id="hongdae" autocomplete="off">
                    <label class="btn btn-outline-danger" for="hongdae">홍대</label>

                    <input type="radio" class="btn-check" name="options-outlined" id="gangnam" autocomplete="off">
                    <label class="btn btn-outline-danger" for="gangnam">강남</label>
                </div>
                <div>
                    지역
                    <input type="radio" class="btn-check" name="options-outlined" id="seoul" autocomplete="off">
                    <label class="btn btn-outline-danger" for="seoul">서울</label>

                    <input type="radio" class="btn-check" name="options-outlined" id="around" autocomplete="off">
                    <label class="btn btn-outline-danger" for="around">경기</label>

                    <input type="radio" class="btn-check" name="options-outlined" id="busan" autocomplete="off">
                    <label class="btn btn-outline-danger" for="busan">부산</label>
                </div>
                <div>
                    내주변
                    <input type="radio" class="btn-check" name="options-outlined" id="mylocation" autocomplete="off">
                    <label class="btn btn-outline-success" for="mylocation">내위치</label>
                </div>
            </div>



        </div>
        <div id="map" style="width:100%;height:350px;"></div>
        <table class="table">
            <thead>
            <tr>
                <th>이름</th>
                <th>시작날짜</th>
                <th>종료날짜</th>
                <th>위치</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="event:${list}">
                <td><span th:text="${event.name }"></span></td>
                <td><span th:text="${event.start_date }"></span></td>
                <td><span th:text="${event.end_date }"></span></td>
                <td><span th:text="${event.addr }"></span></td>
            </tr>
            </tbody>
        </table>
        <script type="text/javascript"
                src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1c7411c7e9cd13cdaac33d749ab11436&libraries=services"></script>
        <script th:inline="javascript">
            $(document).ready(function() {
                $("#state>input").each(function() {
                    $(this).click(function() {
                        let state = $(this).val();
                        $.ajax({
                            url : '/hereevent/map/clicktest',
                            data : {"state" : state},
                            method: 'GET',
                            success: console.log(state)
                        })
                    });
                });
                $("#type>input").each(function() {
                    $(this).click(function() {
                        let type = $(this).val();
                        $.ajax({
                            url : '/hereevent/map/clicktest',
                            data : {"type" : type},
                            method: 'GET',
                            success: console.log(type)
                        })
                    });
                });
            });//end ready




        var map;
        var mapContainer = document.getElementById('map');
        var mapOption = {
            center: new kakao.maps.LatLng(37.54366481430039, 127.05889745872842), // 초기 중심 좌표(성수)
            level: 5 // 초기 확대 레벨
        };

        // 지도 생성
        map = new kakao.maps.Map(mapContainer, mapOption);


        function locationLoadSuccess(pos){
            // 현재 위치 받아오기
            var currentPos = new kakao.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
            map.setCenter(currentPos);
            map.setLevel(5); // 원하는 확대 레벨로 설정
        };

        function locationLoadError(){
            alert('위치 정보를 가져오는데 실패했습니다.');
        };

        function getCurrentPos(){
              navigator.geolocation.getCurrentPosition(function(pos) {
                locationLoadSuccess(pos);
            }, locationLoadError);
        };

        function changeMapLocation(lat, lng, level) {
            map.setCenter(new kakao.maps.LatLng(lat, lng));
            map.setLevel(level); // 필요한 경우에만 확대 레벨 설정
        }


            // 각 버튼 클릭 시 지도 중심 좌표 변경
        document.getElementById('seongsu').addEventListener('click', function() {
            changeMapLocation(37.54366481430039, 127.05889745872842);
        });

        document.getElementById('jamsil').addEventListener('click', function() {
            changeMapLocation(37.509358600639494, 127.1051299097808);
        });

        document.getElementById('hongdae').addEventListener('click', function() {
            changeMapLocation(37.555849659619895, 126.94824554655163);
        });

        document.getElementById('gangnam').addEventListener('click', function() {
            changeMapLocation(37.49783159114859, 127.0339598307763);
        });

        document.getElementById('seoul').addEventListener('click', function() {
            changeMapLocation(37.53814735887608, 126.99898167513268, 8);
        });

        document.getElementById('around').addEventListener('click', function() {
            changeMapLocation(37.369188031896265, 127.01776935446426, 10);
        });

        document.getElementById('busan').addEventListener('click', function() {
            changeMapLocation(35.137294960653996, 129.1042017597341, 9);
        });

        document.getElementById('mylocation').addEventListener('click', function() {
            getCurrentPos();
        });




        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
                crossorigin="anonymous"></script>
    </body>
</html>